# jady.call Standard Interface

이 문서는 `jady.call`의 표준 인터페이스를 정의합니다. 모든 언어의 구현체는 이 문서에 정의된 이름과 구조를 엄격히 준수해야 합니다.

## 0. 기본 원칙 (General Principles)

- **Asynchronous**: 모든 구현체는 기본적으로 **비동기(Async)** 동작을 지향해야 합니다. (Return Promise, Future, Coroutine, etc.)
- **Stateless**: `jady.call`은 상태를 가지지 않는 순수 함수(Pure Function) 혹은 정적 메서드(Static Method)처럼 동작해야 합니다.
    - **No Cookie Jar**: 이전 요청의 `Set-Cookie`를 저장하거나 다음 요청에 자동으로 포함하지 않습니다. (브라우저의 기본 동작은 예외)

## 1. 필수로 포함되어야 할 파라미터 (The Input)

어떤 언어의 `jady.call()`이든 다음 인자들은 동일한 이름으로 존재해야 합니다.

- **baseUrl**: (Optional) 기본 URL (String).
    - `url`이 상대 경로일 경우, `baseUrl`과 결합됩니다.
    - **Slash Handling**: `baseUrl`이 `/`로 끝나고 `url`이 `/`로 시작하는 경우, 슬래시 하나가 제거되어 결합됩니다. (예: `host/` + `/path` -> `host/path`)
    - 반대로 두 값 사이에 슬래시가 없는 경우, 자동으로 `/`를 삽입하여 결합합니다. (예: `host` + `path` -> `host/path`)
    - `url`이 절대 경로(`http://...`)일 경우, `baseUrl`은 무시됩니다.
- **url**: 대상 주소 (String). (Path Parameter가 포함된 경우 `{key}` 또는 `:key` 형식 사용 권장)
- **path**: (Optional) URL Path Parameter 치환 객체 (Object/Dict).
    - `url` 내의 `{key}` 또는 `:key` 패턴을 찾아 해당 값으로 치환합니다.
    - 값은 자동으로 **URL Encoding** 처리되어야 합니다. (예: `id`가 `a/b`면 `a%2Fb`로 치환)
- **method**: HTTP 메서드 (String). (기본값: `GET`. 입력은 대소문자를 구분하지 않으나, 전송 시 **대문자**로 정규화됩니다.)
- **params**: (Optional) Query Parameter (Object/Dict). 표준 URL Encoding (`application/x-www-form-urlencoded`)으로 변환. (공백은 `+`로 인코딩)
    - **배열(Array/List)** 값은 키 반복(`key=v1&key=v2`) 형태로 직렬화합니다.
    - **중첩 객체(Nested Object)**는 지원하지 않습니다. (필요 시 사용자가 JSON 문자열 등으로 변환하여 전달)
    - `url`에 이미 쿼리 스트링이 존재하는 경우, `&`로 연결하여 병합합니다. (URL 끝의 `?`, `&` 중복 처리 필요)
    - **Hash(#) 처리**: URL에 Hash(Fragment)가 포함된 경우, Query String은 반드시 **Hash(#) 앞**에 삽입되어야 합니다.
    - **String / Native**: 문자열이나 `URLSearchParams` 등 네이티브 객체가 전달되면, 별도 변환 없이 그대로 쿼리 스트링으로 사용합니다.
- **paramsArrayFormat**: (Optional) 배열 파라미터 직렬화 방식 (String, 기본값: `'repeat'`).
    - `'repeat'`: `key=v1&key=v2` (기본값)
    - `'brackets'`: `key[]=v1&key[]=v2`
    - `'comma'`: `key=v1,v2`
    - `'index'`: `key[0]=v1&key[1]=v2`
- **paramsSerializer**: (Optional) Query Parameter를 문자열로 변환하는 커스텀 함수. `(params) => string`
    - 이 값이 설정되면 `paramsArrayFormat`은 무시됩니다.
    - 반환값은 맨 앞의 `?`를 포함하지 않아야 합니다.
    - 빈 문자열을 반환하는 경우, URL 끝에 `?`를 붙이지 않아야 합니다.
- **cookies**: (Optional) 요청과 함께 전송할 쿠키 객체 (Object/Dict).
    - `headers`의 `Cookie` 값과 병합됩니다.
    - **Precedence**: `headers`에 `Cookie` 헤더가 이미 존재하는 경우, `cookies` 객체는 직렬화되어 기존 `Cookie` 문자열 뒤에 `; `로 연결됩니다.
- **data**: (Optional) Request Body (Object/Dict, String, Byte Array, Stream).
    - **GET, HEAD 메서드**: `data` 및 `files` 값이 존재하더라도 **무시(Ignored)**하고 전송하지 않습니다. (DELETE 등 그 외 메서드는 본문 전송 허용)
    - **Object/Dict**: 기본적으로 **JSON 직렬화** (`Content-Type: application/json` 자동 추가).
        - 예외: 헤더에 `application/x-www-form-urlencoded`가 명시된 경우, **Query String** 형태로 변환하여 전송합니다.
    - **String**: 그대로 전송 (`Content-Type` 미지정 시 `text/plain; charset=utf-8` 자동 추가).
    - **Byte Array/Buffer**: 그대로 전송 (`Content-Type` 미지정 시 `application/octet-stream` 자동 추가).
    - **Stream**: (Readable Stream, File-like Object) 메모리에 적재하지 않고 스트리밍 전송 (`Content-Type` 미지정 시 `application/octet-stream` 자동 추가).
    - **Form Data (`application/x-www-form-urlencoded`)**: `data`가 객체이고 헤더가 설정된 경우, `params`의 직렬화 규칙(`paramsArrayFormat`, `paramsSerializer`)을 따릅니다.
    - **Native Objects**: `FormData`, `URLSearchParams` (JS) 등 언어별 네이티브 객체가 전달되면, 별도 변환 없이 그대로 전송하며 적절한 `Content-Type`을 자동으로 설정합니다.
        - 이 경우, 사용자가 `headers`에 명시한 `Content-Type`은 **무시**됩니다. (네이티브 객체의 타입이 우선함)
- **files**: (Optional) 파일 업로드 객체 (Multipart/form-data).
    - Key: Field Name, Value: File Object / Blob / Stream / Path(Server-side only) **또는 그 배열(Array)**.
    - **고급 설정**: Value를 `{ file: ..., filename?: string, contentType?: string }` 객체로 전달하여 파일명과 타입을 명시할 수 있습니다. (배열 내부 요소로도 사용 가능)
        - **Tip**: JSON 메타데이터 등 파일이 아닌 파트도 `Content-Type` 지정이 필요하다면 이 방식을 통해 `files`에 포함시킬 수 있습니다.
        - **Default Filename**: Stream이나 Buffer 등 파일명이 없는 객체가 전달되고 `filename` 옵션도 없는 경우, 라이브러리는 `'blob'` 또는 `'file'` 등 **임의의 기본 파일명**을 생성하여 `Content-Disposition` 헤더에 포함해야 합니다. (서버 거부 방지)
    - **Browser Environment**: 브라우저에서는 보안상 파일 경로(String)를 사용할 수 없으며, `File` 또는 `Blob` 객체를 직접 전달해야 합니다.
    - 이 값이 존재하면 `Content-Type` 헤더는 **사용자 설정 값을 무시하고** 자동으로 `multipart/form-data; boundary=...`로 설정됩니다.
- **headers**: (Optional) HTTP 헤더 (Object/Dict).
    - **보안**: Header Value에 줄바꿈 문자(`\n`, `\r`)가 포함된 경우, **예외(Exception)**를 발생시켜야 합니다. (HTTP Response Splitting 방지)
    - **Key Validation**: Header Key에 공백이나 제어 문자 등 HTTP 토큰으로 유효하지 않은 문자가 포함된 경우, **예외**를 발생시켜야 합니다.
    - **처리 규칙**: 라이브러리 내부에서 헤더를 병합하거나 덮어쓸 때, 키(Key)의 **대소문자를 구분하지 않고(Case-insensitive)** 처리해야 합니다. (예: 사용자가 `content-type`을 보내면, 라이브러리가 `Content-Type`을 중복해서 추가하지 않아야 함)
- **preserveHeaderCase**: (Optional) `true` 설정 시, 헤더 키의 대소문자를 정규화하지 않고 그대로 전송합니다. (기본값: `false`)
- **timeout**: (Optional) 요청 타임아웃 (Number, ms 단위, 기본값: 5000 등 언어별 적절한 값). **(시간 초과 시 예외 발생, 0 설정 시 무제한)**
    - **Number**: 설정 시 **각 시도(Attempt)별** 제한 시간으로 동작합니다. (재시도 시 타이머 초기화)
    - **Object**: 세부 타임아웃 설정 가능 (지원하는 플랫폼에 한함).
        - `connect`: 소켓 연결 대기 시간.
        - `write`: 데이터 전송(Upload) 대기 시간. (대용량 업로드 시 유용)
        - `read`: 데이터 수신 대기 시간 (Socket Idle Timeout).
        - `total`: 전체 요청 제한 시간 (재시도 포함). **(이 값이 설정되면 `timeout`은 각 시도별 제한 시간으로 동작)**
        - **Stream Warning**: `responseType: 'stream'` 사용 시, `total`은 스트림 전송이 완료될 때까지의 시간을 제한하므로 주의해서 설정해야 합니다. (대용량 파일의 경우 `0` 권장)
- **maxHeaderSize**: (Optional) 응답 헤더의 최대 크기 제한 (Number, bytes 단위). 초과 시 예외 발생. (기본값: 플랫폼별 기본값 또는 16KB)
- **maxContentLength**: (Optional) 요청 본문의 최대 크기 제한 (Number, bytes 단위). 초과 시 예외 발생. (기본값: 무제한)
- **maxBodyLength**: (Optional) 응답 본문의 최대 크기 제한 (Number, bytes 단위). 초과 시 예외 발생. (기본값: 무제한)
    - `Content-Length` 헤더가 존재하면 이를 기준으로 미리 검사하고, 없으면 수신된 바이트 수를 기준으로 검사합니다.
    - `responseType`이 `'stream'`인 경우, 이 설정은 **무시(Ignored)**되거나 플랫폼 구현에 따라 적용되지 않을 수 있습니다.
- **maxRate**: (Optional) 다운로드 대역폭 제한 (Number, bytes/sec). (지원하는 플랫폼에 한함)
- **expect100**: (Optional) `true` 설정 시, `Expect: 100-continue` 헤더를 전송하고 서버 승인 후 본문을 전송합니다. (대용량 업로드 시 대역폭 절약)
- **blockPrivateIP**: (Optional) `true` 설정 시, DNS 조회 결과가 사설 IP(Private IP) 대역인 경우 요청을 차단합니다. (SSRF 방지)
- **saveRawBody**: (Optional) `true` 설정 시, 파싱된 `body` 외에 원본 텍스트/버퍼를 `rawBody` 필드로 응답 객체에 포함합니다. (HMAC 검증 등에 사용)
    - `responseType`이 `'stream'`인 경우, 이 옵션은 **무시(Ignored)**됩니다. (스트림은 버퍼링되지 않음)
- **requestId**: (Optional) 요청 식별자 (String). (설정하지 않으면 UUID 등을 자동 생성하여 할당 권장)
- **auth**: (Optional) 인증 정보 객체.
    - Basic Auth: `{ username: 'user', password: 'pw' }`
    - Bearer Token: `{ bearer: 'token_string' }` (헤더에 `Authorization: Bearer ...` 자동 추가)
    - 주의: `headers`에 `Authorization` 값이 이미 존재하면, 이 옵션은 **무시**됩니다.
    - **Ambiguity**: Basic, Bearer 등 여러 인증 타입을 동시에 지정하면 **예외**를 발생시켜야 합니다.
- **withCredentials**: (Optional) Cross-Origin 요청 시 쿠키/인증 헤더 포함 여부 (Boolean, 기본값: `false`). (브라우저 Fetch API의 `credentials: 'include'`에 대응)
- **verify**: (Optional) SSL/TLS 인증서 검증 여부 (Boolean, 기본값: `true`).
- **redirect**: (Optional) 리다이렉션 처리 방식 (String, 기본값: `'follow'`).
    - `'follow'`: 3xx 응답을 자동으로 따라갑니다. (최대 10회)
    - **Method Change**: `301`, `302`, `303` 응답 시, 리다이렉트 요청의 메서드는 **`GET`**으로 변경되며 요청 Body는 제거됩니다. (`307`, `308`은 메서드와 Body 유지)
    - `'error'`: 3xx 응답을 네트워크 오류로 처리합니다.
    - `'manual'`: 3xx 응답을 그대로 반환합니다. (상태 코드 확인 필요)
    - **보안**: Cross-Domain 리다이렉트 시 `Authorization`, `Cookie` 헤더는 자동으로 **제거(Strip)**되어야 합니다.
- **maxRedirects**: (Optional) 리다이렉트 최대 허용 횟수 (Number, 기본값: 10). (`redirect: 'follow'`일 때만 적용. 브라우저 환경에서는 보안 정책에 따라 무시되거나 제한될 수 있음)
- **retry**: (Optional) 실패 시 재시도 횟수 (Number, 기본값: 0).
    - 네트워크 오류, 5xx 서버 오류, **429(Too Many Requests)** 응답 시 재시도합니다.
- **retryMethods**: (Optional) 재시도를 허용할 HTTP 메서드 배열 (String[], 기본값: `['GET', 'PUT', 'HEAD', 'DELETE', 'OPTIONS', 'TRACE']`).
    - **POST, PATCH** 등 비멱등(Non-idempotent) 메서드는 기본적으로 재시도하지 않습니다. (중복 처리 방지)
- **retryCondition**: (Optional) 재시도 여부를 결정하는 커스텀 함수. `(error, retryCount) => boolean | Promise<boolean>`
    - 이 함수가 설정되면 `retryMethods` 및 기본 상태 코드 검사는 무시되고, 이 함수의 반환값에 따라 재시도합니다.
- **retryDelay**: (Optional) 재시도 간 대기 시간 (Number | Function, ms 단위, 기본값: 0).
    - **Number**: 고정 대기 시간.
    - **Function**: `(retryCount, error) => number` (지수 백오프 등 동적 계산 가능).
- **socketPath**: (Optional) Unix Domain Socket 경로 (String). (설정 시 `url`의 호스트 부분은 무시됨. 예: `/var/run/docker.sock` 또는 Windows Named Pipe `\\.\pipe\name`)
- **localAddress**: (Optional) 요청을 보낼 로컬 네트워크 인터페이스의 IP 주소 (String). (IP Rotation, Multi-homed 서버 등에서 사용)
- **proxy**: (Optional) 프록시 서버 설정 (String | Object).
    - **String**: `http://user:pass@proxy.com:8080`
    - **Object**: `{ host: string, port: number, protocol?: string, auth?: { username: string, password: string }, headers?: Object, noProxy?: String[] }`
        - `headers`: 프록시 서버로 보낼 커스텀 헤더 (예: `Proxy-Authorization` 수동 설정 등).
        - `noProxy`: 프록시를 거치지 않을 도메인 목록 (예: `['localhost', '.internal']`).
        - **Precedence**: `host` 문자열에 포함된 인증 정보보다 `auth` 필드의 설정이 우선합니다.
    - **Boolean (`false`)**: 시스템 프록시 설정을 무시하고 직접 연결을 강제합니다.
    - 주의: 브라우저 환경에서는 보안 정책상 무시될 수 있습니다.
- **agent**: (Optional) HTTP 연결 풀링(Connection Pooling)을 위한 플랫폼별 에이전트 객체.
    - Node.js: `http.Agent` / `https.Agent` 또는 `{ http: Agent, https: Agent }` (프로토콜별 분리)
    - Java: `OkHttpClient` 인스턴스
    - Python: `Session` 객체 등
    - **주의**: 이 옵션이 설정되면 `proxy`, `ssl`, `keepAlive`, `localAddress`, `family` 등 연결 관련 옵션은 **무시**됩니다. (에이전트의 설정이 우선함)
- **adapter**: (Optional) 실제 네트워크 요청을 수행하는 커스텀 어댑터 함수. `(config) => Promise<Response>`
    - Mocking, 테스팅, 혹은 특수한 프로토콜 처리를 위해 내부 로직을 대체할 때 사용합니다.
- **ssl**: (Optional) SSL/TLS 설정 객체 (Browser 환경에서는 무시됨).
    - `ca`: 커스텀 CA 인증서 (String/Buffer).
    - `cert`: 클라이언트 인증서 (String/Buffer).
    - `key`: 클라이언트 개인키 (String/Buffer).
    - `pfx`: 클라이언트 인증서 (PFX/PKCS12 포맷, String/Buffer).
    - `passphrase`: 개인키 비밀번호 (String).
    - `ciphers`: 사용할 암호화 제품군 목록 (String).
    - `servername`: SNI(Server Name Indication) 오버라이드 (String).
    - `minVersion`: TLS 최소 버전 (String). (예: `'TLSv1.2'`)
    - `maxVersion`: TLS 최대 버전 (String). (예: `'TLSv1.3'`)
- **responseType**: (Optional) 응답 데이터의 타입 지정 (String, 기본값: `'auto'`).
    - `'auto'`: `Content-Type`에 따라 JSON, Text, Binary 자동 처리.
    - `'json'`: 강제로 JSON 파싱 시도. (파싱 실패 시 `'EPARSE'` 예외 발생)
    - `'text'`: 강제로 텍스트로 반환.
    - `'bytes'`: Binary Data (Buffer/Bytes)로 반환.
    - `'arraybuffer'`: `'bytes'`와 동일 (Browser 호환성).
    - `'stream'`: 스트림(Stream) 객체로 반환. (대용량 파일 처리 시 필수)
    - `'blob'`: **Blob** 객체로 반환. (브라우저 환경 등 Blob API 지원 시)
    - `'document'`: **HTML Document** 객체로 반환. (브라우저 환경 등 DOM Parser 지원 시)
- **responseEncoding**: (Optional) 응답 텍스트 디코딩 시 사용할 인코딩 (String, 기본값: `'utf-8'`).
    - `responseType`이 `'text'`, `'json'`이거나 `'auto'`(텍스트로 판별됨)일 때 적용됩니다.
    - `responseType`이 `'stream'`, `'bytes'`, `'arraybuffer'`, `'blob'`인 경우, 이 설정은 **무시(Ignored)**됩니다. (항상 원본 바이너리 반환)
    - 예: `'euc-kr'`, `'windows-1252'`
- **jsonReplacer**: (Optional) JSON 직렬화 시 사용할 변환 함수 또는 화이트리스트 배열. (JS: `JSON.stringify`의 replacer, Python: `default` 함수 등 매핑)
- **jsonReviver**: (Optional) JSON 파싱 시 사용할 변환 함수. (JS: `JSON.parse`의 reviver, Python: `object_hook` 등 매핑)
- **decompress**: (Optional) 응답 본문 자동 압축 해제 여부 (Boolean, 기본값: `true`).
    - `false`로 설정 시, 압축된 바이너리 데이터가 그대로 `body`에 반환됩니다. (다운로드 등에 사용)
    - `true` 설정 시(기본값), `Accept-Encoding: gzip, deflate, br` 헤더가 자동으로 포함됩니다.
- **xsrfCookieName**: (Optional) CSRF 토큰을 읽어올 쿠키 이름 (String, 기본값: `'XSRF-TOKEN'`). (브라우저 환경 전용)
    - **GET, HEAD, OPTIONS, TRACE** 등 읽기 전용 메서드에는 적용되지 않습니다.
- **xsrfHeaderName**: (Optional) CSRF 토큰을 담을 헤더 이름 (String, 기본값: `'X-XSRF-TOKEN'`). (브라우저 환경 전용)
- **validateStatus**: (Optional) 성공(`ok: true`)으로 간주할 상태 코드 범위 지정 함수.
    - 기본값: `(status) => status >= 200 && status < 300`
- **keepAlive**: (Optional) HTTP Keep-Alive 활성화 여부 (Boolean, 기본값: `true`). (성능 최적화)
    - `agent` 옵션이 설정된 경우, 이 값은 무시됩니다.
- **http2**: (Optional) HTTP/2 사용 여부 (Boolean, 기본값: `false`). (지원하는 플랫폼에 한함)
    - `true` 설정 시 ALPN(Application-Layer Protocol Negotiation)을 통해 HTTP/2 연결을 시도하며, 서버가 지원하지 않는 경우 **HTTP/1.1로 자동 폴백(Fallback)**되어야 합니다.
- **cache**: (Optional) 캐시 정책 (String, 기본값: `'default'`).
    - `'default'`, `'no-store'`, `'reload'`, `'no-cache'`, `'force-cache'`, `'only-if-cached'` (Fetch API 표준 준수)
- **family**: (Optional) DNS 조회 시 사용할 IP 버전 (Number).
    - `4`: IPv4만 사용.
    - `6`: IPv6만 사용.
    - `0`: 둘 다 사용 (기본값).
- **lookup**: (Optional) 커스텀 DNS 조회 함수/인터페이스. (언어별 DNS 해석 로직 주입)
- **referrer**: (Optional) 요청 헤더의 Referer 값 (String).
- **referrerPolicy**: (Optional) Referrer 정책 (String). (예: `'no-referrer'`, `'origin'`, `'unsafe-url'` 등)
- **priority**: (Optional) 요청의 우선순위 (String, 기본값: `'auto'`). (Fetch API 표준 준수)
    - `'high'`, `'low'`, `'auto'`
- **integrity**: (Optional) 리소스 무결성 검증을 위한 해시값 (String). (예: `sha384-...`) (Fetch API 표준 준수)
- **signal**: (Optional) 요청 취소를 위한 시그널 객체. (JS: `AbortSignal`, Python/Java: Cancellation Token/Context 등 언어별 표준 취소 메커니즘 매핑)
    - 요청 시작 시점에 이미 시그널이 취소(Aborted) 상태라면, 요청을 보내지 않고 즉시 **`'ECANCELED'` 예외**를 발생시켜야 합니다.
- **onUploadProgress**: (Optional) 업로드 진행률 콜백 함수. `(progressEvent) => void`
    - `progressEvent`: `{ loaded: number, total?: number }` (브라우저 환경의 경우 XHR을 사용하거나, Fetch 스트림 지원이 필요할 수 있음)
    - **Node.js**: Stream 입력의 경우, 전체 크기(`Content-Length`)를 알 수 없으면 `total` 속성이 생략될 수 있습니다.
- **onDownloadProgress**: (Optional) 다운로드 진행률 콜백 함수. `(progressEvent) => void`
    - `progressEvent`: `{ loaded: number, total?: number }` (브라우저 환경의 경우 XHR을 사용하거나, Fetch 스트림 지원이 필요할 수 있음)
    - **Chunked Encoding**: 서버가 `Content-Length`를 보내지 않는 경우(Chunked), `total` 속성은 생략되거나 `0`일 수 있습니다.
- **meta**: (Optional) 사용자 정의 메타데이터 (Object/Dict).
    - 서버로 전송되지 않으며, 응답 객체나 에러 객체에 그대로 전달되어 로깅이나 후처리에 사용됩니다.
- **hooks**: (Optional) 요청 라이프사이클 훅 (Object).
    - `beforeRequest`: `(config) => config | Promise<config>` (요청 전송 전 실행)
    - `afterResponse`: `(response) => response | Promise<response>` (응답 수신 후 실행)
    - `beforeError`: `(error) => error | Promise<error>` (에러 발생 시 실행)
    - `beforeRetry`: `(error, retryCount) => void | boolean | Config | Promise<...>` (재시도 직전 실행)
        - `false` 반환: 재시도 중단.
        - `Config` 객체 반환: 해당 설정으로 다음 재시도를 수행합니다. (프록시 교체 등)
        - **주의**: `Config`를 반환해도 `retryCount`는 초기화되지 않으며, 재시도 정책(횟수, 딜레이)은 원래 `Config`를 따릅니다.
    - `beforeRedirect`: `(options, response) => void | Promise<void>` (리다이렉트 직전 실행. 헤더 수정 등에 사용)
- **trace**: (Optional) 상세 디버깅을 위한 이벤트 콜백 함수. `(event, info) => void`
    - Events: `'lookup'`, `'connect'`, `'socket'`, `'upload'`, `'download'`, `'end'` 등.
- **native**: (Optional) 언어/플랫폼별 전용 옵션 객체. (표준 옵션으로 커버되지 않는 기능 사용 시)
    - 예: `{ fetch: { mode: 'no-cors', keepalive: true }, node: { insecureHTTPParser: true }, py: { stream: true } }`

## 2. 표준 응답 구조 (The Output)

반환값 역시 언어에 상관없이 동일한 객체 구조를 가져야 합니다.

- **status**: HTTP 상태 코드 (Number)
- **statusText**: HTTP 상태 메시지 (String). (예: "OK", "Not Found")
- **duration**: 요청 시작부터 응답 완료까지 걸린 시간 (Number, ms 단위).
- **timings**: (Optional) 구간별 소요 시간 정보 (Object, ms 단위). (지원하는 플랫폼에 한함)
    - `dns`: DNS 조회 시간.
    - `connect`: TCP 연결 시간 (SSL 핸드셰이크 포함).
    - `send`: 요청 전송 시간.
    - `wait`: 서버 응답 대기 시간 (TTFB).
    - `receive`: 데이터 수신 시간.
- **url**: 최종 응답 URL (String). (리다이렉트가 발생한 경우 리다이렉트 된 최종 주소)
- **history**: (Optional) 리다이렉트 기록 배열 (Array<Object>).
    - 리다이렉트가 발생했을 때, 이전 요청들에 대한 간략한 정보(`url`, `status`, `statusText`)를 포함합니다.
- **request**: (Optional) 네이티브 요청 객체 (Object). (Node.js `ClientRequest`, Browser `XMLHttpRequest` 등)
- **config**: 요청 시 사용된 설정 객체 (Object). (`meta` 포함)
- **body**: 실제 응답 데이터.
    - `responseType` 설정이 최우선으로 적용됩니다.
    - **rawBody**: (Optional) `saveRawBody: true`일 때 포함되는 원본 데이터 (String | Buffer).
    - **HEAD 요청**: `body`는 항상 **`null`**입니다.
    - **자동 압축 해제(Decompression)**: `decompress: true`(기본값)일 경우, Gzip, Deflate, Brotli 등으로 압축된 응답은 자동으로 해제된 후 처리됩니다.
    - JSON 응답 (`application/json`): **Object/Dict**로 자동 파싱. **(BOM(Byte Order Mark) 제거 후 파싱, 실패 시 `'EPARSE'` 예외 발생)**
    - 텍스트 응답 (`text/*`): **String**. (인코딩은 `Content-Type` 헤더를 따르며, 명시되지 않은 경우 **UTF-8**을 기본으로 사용)
    - 상태 코드 204 (No Content): **null**.
    - Stream 응답 (`responseType: 'stream'`): 언어별 **Readable Stream** 객체. (사용자가 스트림을 **닫을(Close/Destroy) 책임**이 있습니다)
    - Blob 응답 (`responseType: 'blob'`): **Blob** 객체. (브라우저 환경 등 Blob API 지원 시)
    - 그 외 (이미지, 바이너리 등): **Byte Array / Buffer**.
- **headers**: 응답 헤더 (Object). **모든 Key는 소문자(lowercase)로 정규화**됩니다.
    - 기본값: **String** (여러 값인 경우 `, `로 결합).
    - 예외: **`set-cookie`**는 **String[] (배열)** 형태로 반환해야 합니다. (쿠키 파싱 및 세션 관리를 위함. 단, 브라우저 환경에서는 보안상 접근 불가할 수 있음)
- **ok**: 성공 여부 (Boolean, 200~299 사이면 true)

## 3. 에러 처리 (Error Handling)

- **네트워크 오류**: DNS 조회 실패, 연결 거부 등 아예 응답을 받지 못한 경우는 **예외(Exception)**를 발생시켜야 합니다.
- **HTTP 오류**: 4xx, 5xx 응답은 예외가 아니라 정상 응답으로 간주하며, `ok: false`와 해당 `status`를 반환합니다.
- **표준 에러 코드 (Standard Error Codes)**: 발생한 예외 객체는 가능한 한 다음 `code` 속성을 포함해야 합니다.
    - `'ETIMEDOUT'`: 요청 타임아웃.
    - `'ECANCELED'`: 요청 취소 (Signal).
    - `'ENETWORK'`: 네트워크 연결 실패.
    - `'EPARSE'`: 응답 데이터 파싱 실패 (`responseType: 'json'` 등).
    - `'EMAXSIZE'`: 응답 본문 크기 제한 초과.
    - `'EMAXREDIRECTS'`: 리다이렉트 횟수 초과.
- **에러 객체 구조 (Error Object Structure)**:
    - `code`: 표준 에러 코드 (String).
    - `message`: 에러 메시지 (String).
    - `response`: (Optional) 응답 객체. (응답을 받았으나 에러인 경우, 또는 파싱 에러 시 포함)
        - `status`, `headers`, `body` (Raw Data) 등을 포함해야 합니다.
    - `timings`: (Optional) 에러 발생 전까지 측정된 구간별 소요 시간 정보. (디버깅에 유용)
    - `config`: 요청 설정 객체.

## 4. 타입 지원 (Type Support - 권장사항)

- **Generics**: TypeScript, Java, Go 등 정적 타입 언어에서는 `body`의 타입을 추론할 수 있도록 제네릭(Generics) 인터페이스를 제공하는 것을 권장합니다.
  - 예: `jady.call<MyResponse>(...)`

## 5. 데이터 처리 규칙 (Data Handling Rules)

- **Query Parameters (`params`)**:
    - `null`, `undefined`: **제외(Omit)**합니다.
    - **빈 배열(`[]`)**: **제외(Omit)**합니다.
    - **빈 문자열(`""`)**: `key=` 형태로 전송합니다.
    - **배열 내부**의 `null`, `undefined` 값도 **제외**합니다. (예: `[1, null, 2]` -> `key=1&key=2`)
    - **Date 객체**: **ISO 8601** 문자열(`YYYY-MM-DDTHH:mm:ss.sssZ`)로 변환합니다.
    - **Number**: 문자열로 변환합니다. (예: `123` -> `"123"`)
    - `true`, `false`: 문자열 `"true"`, `"false"`로 변환합니다.
- **JSON Body (`data`)**:
    - `undefined`: **제외(Omit)**합니다.
    - `null`: **`null` 값 그대로 전송**합니다. (DB 필드 초기화 등의 목적)
    - **NaN, Infinity**: **`null`**로 변환합니다. (JSON 표준 준수)
    - **Circular Reference**: 순환 참조가 포함된 객체는 직렬화 시 **예외**를 발생시켜야 합니다.
    - **Large Integer (JS)**: JavaScript 환경에서 64-bit 정수(BigInt)는 `JSON.parse` 시 정밀도 손실이 발생할 수 있습니다. 이 경우 `responseType: 'text'` 사용을 권장합니다.
    - **Empty Response**: `responseType: 'json'`일 때 응답 본문이 비어있으면(Length 0), **`null`**을 반환합니다. (파싱 에러 방지)
- **Headers (`headers`)**:
    - `undefined`: **제외(Omit)**합니다. (기본 헤더가 있다면 적용됨)
    - `null`: **제거(Remove)**합니다. (기본 헤더가 있어도 전송하지 않음)
    - **배열(Array)** 값: 쉼표(`,`)로 이어 붙여 하나의 문자열로 만듭니다. (예: `['a', 'b']` -> `"a,b"`)
    - **Boolean 값**: 소문자 문자열 `"true"`, `"false"`로 변환합니다. (언어별 `True`/`true` 차이 제거)
    - **Date 객체**: **HTTP Date** 형식(UTC String)으로 변환합니다. (예: `Wed, 21 Oct 2015 07:28:00 GMT`)
    - 그 외의 값: **문자열(String)**로 변환하여 전송합니다.
    - **Key 매칭**: 내부 로직에서 헤더를 확인할 때(예: `Content-Type`), **대소문자를 구분하지 않고(Case-insensitive)** 처리해야 합니다.

- **Multipart Body (`data` + `files`)**:
    - `files`가 존재하여 `multipart/form-data`로 전송되는 경우, `data` 필드의 처리 규칙:
        - **제약 사항**: `data`는 반드시 **Plain Object**여야 합니다. (`FormData`, `URLSearchParams`, `Stream` 등 네이티브 객체와 혼용 불가)
        - **Key Collision**: `data`와 `files`에 동일한 키가 존재할 경우, 덮어쓰지 않고 **두 값 모두 전송(Multi-value)**됩니다.
        - `null`, `undefined`: **제외(Omit)**합니다.
        - **배열(Array)**: `paramsArrayFormat` 설정에 따라 직렬화합니다. (기본값: 동일 Key 반복)
        - **Date 객체**: **ISO 8601** 문자열로 변환하여 전송합니다.
        - **Boolean 값**: 소문자 문자열 `"true"`, `"false"`로 변환하여 전송합니다.
        - **객체(Object)**: JSON 문자열로 변환하여 전송합니다.
        - 그 외: 문자열로 변환하여 전송합니다.

## 6. 환경 및 기본값 (Environment & Defaults)

- **System Proxy**: `proxy` 옵션이 지정되지 않은 경우, 시스템 환경 변수(`HTTP_PROXY`, `HTTPS_PROXY`, `NO_PROXY`)를 자동으로 감지하여 적용해야 합니다. (브라우저 환경 제외)
- **Default Headers**:
    - **Accept**: 명시되지 않은 경우 `application/json, text/plain, */*`을 기본으로 전송합니다. (브라우저 환경 제외)
    - **User-Agent**: `jady-call` 식별자를 포함하는 것을 권장합니다. (브라우저 환경 제외)